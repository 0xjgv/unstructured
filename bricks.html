<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Examples" href="examples.html" /><link rel="prev" title="Elements" href="elements.html" />

    <link rel="shortcut icon" href="_static/unstructured_small.png"/><!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Bricks - Unstructured 0.4.11 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/unstructured.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-sidebar-background: #FFFFFF;
  --color-sidebar-background-border: #e9eaed;
  --color-sidebar-caption-text: #484848;
  --color-sidebar-link-text: #484848;
  --color-sidebar-link-text--top-level: #484848;
  --color-sidebar-item-background--current: transparent;
  --color-sidebar-item-background--hover: transparent;
  --color-sidebar-item-expander-background: transparent;
  --color-sidebar-item-expander-background--hover: transparent;
  --color-sidebar-search-text: #484848;
  --color-sidebar-search-background: #FFFFFF;
  --color-sidebar-search-background--focus: #FFFFFF;
  --color-sidebar-search-border: #b9b9b9;
  --color-sidebar-search-border-focus: #484848;
  --color-sidebar-current-text: #ff675f;
  --color-content-foreground: #484848;
  --color-toc-title: #212529;
  --color-toc-item-text--hover: #484848;
  --color-toc-item-text--active: #484848;
  --color-table-header: #FDDACA;
  --color-table-bg: #FFE5D9;
  --color-table-row: #FEEDE6;
  --color-link: #ff675f;
  --color-link--hover: #ff675f;
  --content-padding: 5em;
  --content-padding--small: 2em;
  --color-search-icon: #484848;
  --color-search-placeholder: #484848;
  --color-literal: #FF675F;
  --toc-spacing-vertical: 3em;
  --color-page-info: #646776;
  --toc-item-spacing-vertical: 1em;
  --color-img-background: #ffffff;
  --sidebar-tree-space-above: 0;
  --sidebar-caption-space-above: 0;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-sidebar-background: #131416;
  --color-sidebar-background-border: #303335;
  --color-sidebar-caption-text: #FFFFFF;
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--current: none;
  --color-sidebar-item-background--hover: none;
  --color-sidebar-item-expander-background: transparent;
  --color-sidebar-item-expander-background--hover: transparent;
  --color-sidebar-search-text: #FFFFFF;
  --color-sidebar-search-background: #131416;
  --color-sidebar-search-background--focus: transparent;
  --color-sidebar-search-border: #FFFFFF;
  --color-sidebar-search-border-focus: #FFFFFF;
  --color-sidebar-search-foreground: #FFFFFF;
  --color-sidebar-current-text: #FFC2BF;
  --color-content-foreground: #FFFFFF;
  --color-toc-title: #FFFFFF;
  --color-toc-item-text--hover: #FFFFFF;
  --color-toc-item-text--active: #FFFFFF;
  --color-table-header: #131416;
  --color-table-bg: #232427;
  --color-table-row: #444444;
  --color-link: #FFC2BF;
  --color-link--hover: #FFC2BF;
  --color-search-icon: #FFFFFF;
  --color-search-placeholder: #FFFFFF;
  --color-literal: #F8C0A7;
  --color-page-info: #FFFFFF;
  --color-img-background: #757575;
  --sidebar-tree-space-above: 0;
  --sidebar-caption-space-above: 0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-sidebar-background: #131416;
  --color-sidebar-background-border: #303335;
  --color-sidebar-caption-text: #FFFFFF;
  --color-sidebar-link-text: #FFFFFF;
  --color-sidebar-link-text--top-level: #FFFFFF;
  --color-sidebar-item-background--current: none;
  --color-sidebar-item-background--hover: none;
  --color-sidebar-item-expander-background: transparent;
  --color-sidebar-item-expander-background--hover: transparent;
  --color-sidebar-search-text: #FFFFFF;
  --color-sidebar-search-background: #131416;
  --color-sidebar-search-background--focus: transparent;
  --color-sidebar-search-border: #FFFFFF;
  --color-sidebar-search-border-focus: #FFFFFF;
  --color-sidebar-search-foreground: #FFFFFF;
  --color-sidebar-current-text: #FFC2BF;
  --color-content-foreground: #FFFFFF;
  --color-toc-title: #FFFFFF;
  --color-toc-item-text--hover: #FFFFFF;
  --color-toc-item-text--active: #FFFFFF;
  --color-table-header: #131416;
  --color-table-bg: #232427;
  --color-table-row: #444444;
  --color-link: #FFC2BF;
  --color-link--hover: #FFC2BF;
  --color-search-icon: #FFFFFF;
  --color-search-placeholder: #FFFFFF;
  --color-literal: #F8C0A7;
  --color-page-info: #FFFFFF;
  --color-img-background: #757575;
  --sidebar-tree-space-above: 0;
  --sidebar-caption-space-above: 0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Unstructured 0.4.11 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/images/logo-light-mode.svg" alt="Light Logo" />
    <img class="sidebar-logo only-dark" src="_static/images/logo-dark-mode.svg" alt="Dark Logo" />
  </div>
  
  
</a>
<div class="social social--sidebar" style="margin-top: 1em; display: flex; justify-content: right; gap: 8px">
  <a href="https://join.slack.com/t/unstructuredw-kbe4326/shared_invite/zt-1nlh1ot5d-dfY7zCRlhFboZrIWLA4Qgw"
    class="button--primary" target="_blank">Join <span aria-label="slack" class="slack-icon"></span></span></a>
    <div class="github-stars github-stars--sidebar"></div>
</div><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Library Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="elements.html">Elements</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Bricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="bricks">
<h1>Bricks<a class="headerlink" href="#bricks" title="Permalink to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">unstructured</span></code> library provides bricks to make it quick and
easy to parse documents and create new pre-processing pipelines. The following documents
bricks currently available in the library.</p>
<section id="partitioning">
<h2>Partitioning<a class="headerlink" href="#partitioning" title="Permalink to this heading"></a></h2>
<p>The partitioning bricks in <code class="docutils literal notranslate"><span class="pre">unstructured</span></code> differentiate between different sections
of text in a document. For example, the partitioning bricks can help distinguish between
titles, narrative text, and tables.</p>
<section id="partition">
<h3><code class="docutils literal notranslate"><span class="pre">partition</span></code><a class="headerlink" href="#partition" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition</span></code> brick is the simplest way to partition a document in <code class="docutils literal notranslate"><span class="pre">unstructured</span></code>.
If you call the <code class="docutils literal notranslate"><span class="pre">partition</span></code> function, <code class="docutils literal notranslate"><span class="pre">unstructured</span></code> will attempt to detect the
file type and route it to the appropriate partitioning brick. All partitioning bricks
called within <code class="docutils literal notranslate"><span class="pre">partition</span></code> are called using the defualt kwargs. Use the document-type
specific bricks if you need to apply non-default settings.
<code class="docutils literal notranslate"><span class="pre">partition</span></code> currently supports <code class="docutils literal notranslate"><span class="pre">.docx</span></code>, <code class="docutils literal notranslate"><span class="pre">.doc</span></code>, <code class="docutils literal notranslate"><span class="pre">.pptx</span></code>, <code class="docutils literal notranslate"><span class="pre">.eml</span></code>, <code class="docutils literal notranslate"><span class="pre">.html</span></code>, <code class="docutils literal notranslate"><span class="pre">.pdf</span></code>,
<code class="docutils literal notranslate"><span class="pre">.png</span></code>, <code class="docutils literal notranslate"><span class="pre">.jpg</span></code>, and <code class="docutils literal notranslate"><span class="pre">.txt</span></code> files.
If you set the <code class="docutils literal notranslate"><span class="pre">include_page_breaks</span></code> kwarg to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the output will include page breaks. This is only supported for <code class="docutils literal notranslate"><span class="pre">.pptx</span></code>, <code class="docutils literal notranslate"><span class="pre">.html</span></code>, <code class="docutils literal notranslate"><span class="pre">.pdf</span></code>,
<code class="docutils literal notranslate"><span class="pre">.png</span></code>, and <code class="docutils literal notranslate"><span class="pre">.jpg</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">docx</span>

<span class="kn">from</span> <span class="nn">unstructured.partition.auto</span> <span class="kn">import</span> <span class="n">partition</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">()</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;Important Analysis&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Heading 1&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;Here is my first thought.&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Body Text&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;Here is my second thought.&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Normal&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;mydoc.docx&quot;</span><span class="p">)</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;mydoc.docx&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;mydoc.docx&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.auto</span> <span class="kn">import</span> <span class="n">partition</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example-docs/layout-parser-paper-fast.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-docx">
<h3><code class="docutils literal notranslate"><span class="pre">partition_docx</span></code><a class="headerlink" href="#partition-docx" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_docx</span></code> partitioning brick pre-processes Microsoft Word documents
saved in the <code class="docutils literal notranslate"><span class="pre">.docx</span></code> format. This staging brick uses a combination of the styling
information in the document and the structure of the text to determine the type
of a text element. The <code class="docutils literal notranslate"><span class="pre">partition_docx</span></code> can take a filename or file-like object
as input, as shown in the two examples below.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">docx</span>

<span class="kn">from</span> <span class="nn">unstructured.partition.docx</span> <span class="kn">import</span> <span class="n">partition_docx</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">()</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;Important Analysis&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Heading 1&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;Here is my first thought.&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Body Text&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s2">&quot;Here is my second thought.&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;Normal&quot;</span><span class="p">)</span>
<span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;mydoc.docx&quot;</span><span class="p">)</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_docx</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;mydoc.docx&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;mydoc.docx&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="n">partition_docx</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-doc">
<h3><code class="docutils literal notranslate"><span class="pre">partition_doc</span></code><a class="headerlink" href="#partition-doc" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_doc</span></code> partitioning brick pre-processes Microsoft Word documents
saved in the <code class="docutils literal notranslate"><span class="pre">.doc</span></code> format. This staging brick uses a combination of the styling
information in the document and the structure of the text to determine the type
of a text element. The <code class="docutils literal notranslate"><span class="pre">partition_doc</span></code> can take a filename or file-like object
as input, as shown in the two examples below. <code class="docutils literal notranslate"><span class="pre">partiton_doc</span></code>
uses <code class="docutils literal notranslate"><span class="pre">libreoffice</span></code> to convert the file to <code class="docutils literal notranslate"><span class="pre">.docx</span></code> and then
calls <code class="docutils literal notranslate"><span class="pre">partition_docx</span></code>. Ensure you have <code class="docutils literal notranslate"><span class="pre">libreoffice</span></code> installed
before using <code class="docutils literal notranslate"><span class="pre">partition_doc</span></code>.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.doc</span> <span class="kn">import</span> <span class="n">partition_doc</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_doc</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example-docs/fake.doc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-pptx">
<h3><code class="docutils literal notranslate"><span class="pre">partition_pptx</span></code><a class="headerlink" href="#partition-pptx" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_pptx</span></code> partitioning brick pre-processes Microsoft PowerPoint documents
saved in the <code class="docutils literal notranslate"><span class="pre">.pptx</span></code> format. This staging brick uses a combination of the styling
information in the document and the structure of the text to determine the type
of a text element. The <code class="docutils literal notranslate"><span class="pre">partition_pptx</span></code> can take a filename or file-like object
as input, as shown in the two examples below.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.pptx</span> <span class="kn">import</span> <span class="n">partition_pptx</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_pptx</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example-docs/fake-power-point.pptx&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-power-point.pptx&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="n">partition_pptx</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-html">
<h3><code class="docutils literal notranslate"><span class="pre">partition_html</span></code><a class="headerlink" href="#partition-html" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_html</span></code> function partitions an HTML document and returns a list
of document <code class="docutils literal notranslate"><span class="pre">Element</span></code> objects. <code class="docutils literal notranslate"><span class="pre">partition_html</span></code> can take a filename, file-like
object, or string as input. The three examples below all produce the same output.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.html</span> <span class="kn">import</span> <span class="n">partition_html</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_html</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example-docs/example-10k.html&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/example-10k.html&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="n">partition_html</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/example-10k.html&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_html</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-pdf">
<h3><code class="docutils literal notranslate"><span class="pre">partition_pdf</span></code><a class="headerlink" href="#partition-pdf" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_pdf</span></code> function segments a PDF document by using a document image analysis model.
If you set <code class="docutils literal notranslate"><span class="pre">url=None</span></code>, the document image analysis model will execute locally. You need to install <code class="docutils literal notranslate"><span class="pre">unstructured[local-inference]</span></code>
if you’d like to run inference locally.
If you set the URL, <code class="docutils literal notranslate"><span class="pre">partition_pdf</span></code> will make a call to a remote inference server.
<code class="docutils literal notranslate"><span class="pre">partition_pdf</span></code> also includes a <code class="docutils literal notranslate"><span class="pre">token</span></code> function that allows you to pass in an authentication
token for a remote API call.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.pdf</span> <span class="kn">import</span> <span class="n">partition_pdf</span>

<span class="c1"># Returns a List[Element] present in the pages of the parsed pdf document</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_pdf</span><span class="p">(</span><span class="s2">&quot;example-docs/layout-parser-paper-fast.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-image">
<h3><code class="docutils literal notranslate"><span class="pre">partition_image</span></code><a class="headerlink" href="#partition-image" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_image</span></code> function has the same API as <code class="docutils literal notranslate"><span class="pre">partition_pdf</span></code>, which is document above.
The only difference is that <code class="docutils literal notranslate"><span class="pre">partition_image</span></code> does not need to convert a PDF to an image
prior to processing. The <code class="docutils literal notranslate"><span class="pre">partition_image</span></code> function supports <code class="docutils literal notranslate"><span class="pre">.png</span></code> and <code class="docutils literal notranslate"><span class="pre">.jpg</span></code> files.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.image</span> <span class="kn">import</span> <span class="n">partition_image</span>

<span class="c1"># Returns a List[Element] present in the pages of the parsed image document</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_image</span><span class="p">(</span><span class="s2">&quot;example-docs/layout-parser-paper-fast.jpg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-email">
<h3><code class="docutils literal notranslate"><span class="pre">partition_email</span></code><a class="headerlink" href="#partition-email" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_email</span></code> function partitions <code class="docutils literal notranslate"><span class="pre">.eml</span></code> documents and works with exports
from email clients such as Microsoft Outlook and Gmail. The <code class="docutils literal notranslate"><span class="pre">partition_email</span></code>
takes a filename, file-like object, or raw text as input and produces a list of
document <code class="docutils literal notranslate"><span class="pre">Element</span></code> objects as output. Also <code class="docutils literal notranslate"><span class="pre">content_source</span></code> can be set to <code class="docutils literal notranslate"><span class="pre">text/html</span></code>
(default) or <code class="docutils literal notranslate"><span class="pre">text/plain</span></code> to process the html or plain text version of the email, respectively.
In order for <code class="docutils literal notranslate"><span class="pre">partition_email</span></code> to also return the header information (e.g. sender, recipient,
attachment, etc.), <code class="docutils literal notranslate"><span class="pre">include_headers</span></code> must be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Returns tuple with body elements
first and header elements second, if <code class="docutils literal notranslate"><span class="pre">include_headers</span></code> is True.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.email</span> <span class="kn">import</span> <span class="n">partition_email</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_email</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example-docs/fake-email.eml&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-email.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="n">partition_email</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-email.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_email</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-email.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_email</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">content_source</span><span class="o">=</span><span class="s2">&quot;text/plain&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-email.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_email</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">include_headers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="partition-text">
<h3><code class="docutils literal notranslate"><span class="pre">partition_text</span></code><a class="headerlink" href="#partition-text" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">partition_text</span></code> function partitions text files. The <code class="docutils literal notranslate"><span class="pre">partition_text</span></code>
takes a filename, file-like object, and raw text as input and produces <code class="docutils literal notranslate"><span class="pre">Element</span></code> objects as output.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text</span> <span class="kn">import</span> <span class="n">partition_text</span>

<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_text</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;example-docs/fake-text.txt&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-text.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">elements</span> <span class="o">=</span> <span class="n">partition_text</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-text.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">partition_text</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-attachment-info">
<h3><code class="docutils literal notranslate"><span class="pre">extract_attachment_info</span></code><a class="headerlink" href="#extract-attachment-info" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">extract_attachment_info</span></code> function takes an <code class="docutils literal notranslate"><span class="pre">email.message.Message</span></code> object
as input and returns the a list of dictionaries containing the attachment information,
such as <code class="docutils literal notranslate"><span class="pre">filename</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">payload</span></code>, etc. The attachment is saved to the <code class="docutils literal notranslate"><span class="pre">output_dir</span></code>
if specified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">email</span>
<span class="kn">from</span> <span class="nn">unstructured.partition.email</span> <span class="kn">import</span> <span class="n">extract_attachment_info</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example-docs/fake-email-attachment.eml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">message_from_file</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">attachment_info</span> <span class="o">=</span> <span class="n">extract_attachment_info</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;example-docs&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="is-bulleted-text">
<h3><code class="docutils literal notranslate"><span class="pre">is_bulleted_text</span></code><a class="headerlink" href="#is-bulleted-text" title="Permalink to this heading"></a></h3>
<p>Uses regular expression patterns to check if a snippet of text is a bullet point. Only
triggers if the bullet point appears at the start of the snippet.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">is_bulleted_text</span>

<span class="c1"># Returns True</span>
<span class="n">is_bulleted_text</span><span class="p">(</span><span class="s2">&quot;● An excellent point!&quot;</span><span class="p">)</span>

<span class="c1"># Returns False</span>
<span class="n">is_bulleted_text</span><span class="p">(</span><span class="s2">&quot;I love Morse Code! ●●●&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="is-possible-narrative-text">
<h3><code class="docutils literal notranslate"><span class="pre">is_possible_narrative_text</span></code><a class="headerlink" href="#is-possible-narrative-text" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">is_possible_narrative_text</span></code> function determines if a section of text is a candidate
for consideration as narrative text. The function performs the following checks on input text:</p>
<ul class="simple">
<li><p>Empty text cannot be narrative text</p></li>
<li><p>Text that is all numeric cannot be narrative text</p></li>
<li><p>Text that does not contain a verb cannot be narrative text</p></li>
<li><p>Narrative text must contain at least one English word (if <code class="docutils literal notranslate"><span class="pre">language</span></code> is set to “en”)</p></li>
<li><p>Text that exceeds the specified caps ratio cannot be narrative text. The threshold
is configurable with the <code class="docutils literal notranslate"><span class="pre">cap_threshold</span></code> kwarg. To ignore this check, you can set
<code class="docutils literal notranslate"><span class="pre">cap_threshold=1.0</span></code>. You can also set the threshold by using the
<code class="docutils literal notranslate"><span class="pre">UNSTRUCTURED_NARRATIVE_TEXT_CAP_THRESHOLD</span></code> environment variable. The environment variable
takes precedence over the kwarg.</p></li>
<li><p>If a the text contains too many non-alpha characters it is
not narrative text.
The default is to expect a minimum of 50% alpha characters
(not countings spaces). You can change the minimum value with the
<code class="docutils literal notranslate"><span class="pre">non_alpha_ratio</span></code> kwarg or the <code class="docutils literal notranslate"><span class="pre">UNSTRUCTURED_NARRATIVE_TEXT_NON_ALPHA_RATIO</span></code> environment variable.
The environment variables takes precedence over the kwarg.</p></li>
<li><p>The cap ratio test does not apply to text that is all uppercase.</p></li>
<li><p>If you use the <code class="docutils literal notranslate"><span class="pre">language=&quot;&quot;</span></code> kwarg or set the <code class="docutils literal notranslate"><span class="pre">UNSTRUCTURED_LANGUAGE</span></code> environment variable to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>, the function will skip the verb check and the English word check.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">is_possible_narrative_text</span>

<span class="c1"># Returns True because the example passes all the checks</span>
<span class="n">example_1</span> <span class="o">=</span> <span class="s2">&quot;Make sure you brush your teeth before you go to bed.&quot;</span>
<span class="n">is_possible_narrative_text</span><span class="p">(</span><span class="n">example_1</span><span class="p">)</span>

<span class="c1"># Returns False because the text exceeds the caps ratio and does not contain a verb</span>
<span class="n">example_2</span> <span class="o">=</span> <span class="s2">&quot;ITEM 1A. RISK FACTORS&quot;</span>
<span class="n">is_possible_narrative_text</span><span class="p">(</span><span class="n">example_2</span><span class="p">)</span>

<span class="c1"># Returns True because the text has a verb and does not exceed the cap_threshold</span>
<span class="n">example_3</span> <span class="o">=</span> <span class="s2">&quot;OLD MCDONALD HAD A FARM&quot;</span>
<span class="n">is_possible_narrative_text</span><span class="p">(</span><span class="n">example_3</span><span class="p">,</span> <span class="n">cap_threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="is-possible-title">
<h3><code class="docutils literal notranslate"><span class="pre">is_possible_title</span></code><a class="headerlink" href="#is-possible-title" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">is_possible_title</span></code> function determines if a section of text is a candidate
for consideration as a title. The function performs the following checks:</p>
<ul class="simple">
<li><p>Empty text cannot be a title</p></li>
<li><p>Text that is all numeric cannot be a title.</p></li>
<li><p>If a title contains too many words it is not a title. The default max length is <code class="docutils literal notranslate"><span class="pre">12</span></code>. You can change the max length with
the <code class="docutils literal notranslate"><span class="pre">title_max_word_length</span></code> kwarg or the <code class="docutils literal notranslate"><span class="pre">UNSTRUCTURED_TITLE_MAX_WORD_LENGTH</span></code> environment variable. The environment
variable takes precedence over the kwarg.</p></li>
<li><p>If a text contains too many non-alpha characters it is not a
title. The default is to expect a minimum of 50% alpha characters
(not countings spaces). You can change the minimum value with the
<code class="docutils literal notranslate"><span class="pre">non_alpha_ratio</span></code> kwarg or the <code class="docutils literal notranslate"><span class="pre">UNSTRUCTURED_TITLE_NON_ALPHA_RATIO</span></code> environment variable.
The environment variables takes precedence over the kwarg.</p></li>
<li><p>Narrative text must contain at least one English word (if <code class="docutils literal notranslate"><span class="pre">language</span></code> is set to “en”)</p></li>
<li><p>If a title contains more than one sentence that exceeds a certain length, it cannot be a title. Sentence length threshold is controlled by the <code class="docutils literal notranslate"><span class="pre">sentence_min_length</span></code> kwarg and defaults to 5.</p></li>
<li><p>If a segment of text ends in a comma, it is not considered a potential title. This is to avoid salutations like “To My Dearest Friends,” getting flagged as titles.</p></li>
<li><p>If you use the <code class="docutils literal notranslate"><span class="pre">language=&quot;&quot;</span></code> kwarg or set the <code class="docutils literal notranslate"><span class="pre">UNSTRUCTURED_LANGUAGE</span></code> environment variable to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>, the function will skip the English word check.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">is_possible_title</span>

<span class="c1"># Returns True because the text passes all the tests</span>
<span class="n">example_2</span> <span class="o">=</span> <span class="s2">&quot;ITEM 1A. RISK FACTORS&quot;</span>
<span class="n">is_possible_title</span><span class="p">(</span><span class="n">example_2</span><span class="p">)</span>

<span class="c1"># Returns True because there is only one sentence</span>
<span class="n">example_2</span> <span class="o">=</span> <span class="s2">&quot;Make sure you brush your teeth before you go to bed.&quot;</span>
<span class="n">is_possible_title</span><span class="p">(</span><span class="n">example_2</span><span class="p">,</span> <span class="n">sentence_min_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Returns False because there are two sentences</span>
<span class="n">example_3</span> <span class="o">=</span> <span class="s2">&quot;Make sure you brush your teeth. Do it before you go to bed.&quot;</span>
<span class="n">is_possible_title</span><span class="p">(</span><span class="n">example_3</span><span class="p">,</span> <span class="n">sentence_min_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="contains-us-phone-number">
<h3><code class="docutils literal notranslate"><span class="pre">contains_us_phone_number</span></code><a class="headerlink" href="#contains-us-phone-number" title="Permalink to this heading"></a></h3>
<p>Checks to see if a section of text contains a US phone number.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">contains_us_phone_number</span>

<span class="c1"># Returns True because the text includes a phone number</span>
<span class="n">contains_us_phone_number</span><span class="p">(</span><span class="s2">&quot;Phone number: 215-867-5309&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="contains-verb">
<h3><code class="docutils literal notranslate"><span class="pre">contains_verb</span></code><a class="headerlink" href="#contains-verb" title="Permalink to this heading"></a></h3>
<p>Checks if the text contains a verb. This is used in <code class="docutils literal notranslate"><span class="pre">is_possible_narrative_text</span></code>, but can
be used independently as well. The function identifies verbs using the NLTK part of speech
tagger. Text that is all upper case is lower cased before part of speech detection. This is
because the upper case letters sometimes cause the part of speech tagger to miss verbs.
The following part of speech tags are identified as verbs:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VB</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VBG</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VBD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VBN</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VBP</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VBZ</span></code></p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">contains_verb</span>

<span class="c1"># Returns True because the text contains a verb</span>
<span class="n">example_1</span> <span class="o">=</span> <span class="s2">&quot;I am going to run to the store to pick up some milk.&quot;</span>
<span class="n">contains_verb</span><span class="p">(</span><span class="n">example_1</span><span class="p">)</span>

<span class="c1"># Returns False because the text does not contain a verb</span>
<span class="n">example_2</span> <span class="o">=</span> <span class="s2">&quot;A friendly dog&quot;</span>
<span class="n">contains_verb</span><span class="p">(</span><span class="n">example_2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sentence-count">
<h3><code class="docutils literal notranslate"><span class="pre">sentence_count</span></code><a class="headerlink" href="#sentence-count" title="Permalink to this heading"></a></h3>
<p>Counts the number of sentences in a section of text. Optionally, you can only include
sentences that exceed a specified word count. Punctuation counts as a word token
in the sentence. The function uses the NLTK sentence and word tokeniers to identify
distinct sentences and words.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">sentence_count</span>

<span class="n">example</span> <span class="o">=</span> <span class="s2">&quot;Look at me! I am a document with two sentences.&quot;</span>

<span class="c1"># Returns 2 because the example contains two sentences</span>
<span class="n">sentence_count</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>

<span class="c1"># Returns 1 because the first sentence in the example does not contain five word tokens.</span>
<span class="n">sentence_count</span><span class="p">(</span><span class="n">example</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exceeds-cap-ratio">
<h3><code class="docutils literal notranslate"><span class="pre">exceeds_cap_ratio</span></code><a class="headerlink" href="#exceeds-cap-ratio" title="Permalink to this heading"></a></h3>
<p>Determines if the section of text exceeds the specified caps ratio. Used in
<code class="docutils literal notranslate"><span class="pre">is_possible_narrative_text</span></code> and <code class="docutils literal notranslate"><span class="pre">is_possible_title</span></code>, but can be used independently
as well. You can set the caps threshold using the <code class="docutils literal notranslate"><span class="pre">threshold</span></code> kwarg. The threshold
defaults to <code class="docutils literal notranslate"><span class="pre">0.3</span></code>. Only runs on sections of text that are a single sentence. The caps ratio check does not apply to text that is all capitalized.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.partition.text_type</span> <span class="kn">import</span> <span class="n">exceeds_cap_ratio</span>

<span class="c1"># Returns True because the text is more than 30% caps</span>
<span class="n">example_1</span> <span class="o">=</span> <span class="s2">&quot;LOOK AT ME I AM YELLING&quot;</span>
<span class="n">exceeds_cap_ratio</span><span class="p">(</span><span class="n">example_1</span><span class="p">)</span>

<span class="c1"># Returns False because the text is less than 30% caps</span>
<span class="n">example_2</span> <span class="o">=</span> <span class="s2">&quot;Look at me, I am no longer yelling&quot;</span>
<span class="n">exceeds_cap_ratio</span><span class="p">(</span><span class="n">example_2</span><span class="p">)</span>

<span class="c1"># Returns False because the text is more than 1% caps</span>
<span class="n">exceeds_cap_ratio</span><span class="p">(</span><span class="n">example_2</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="cleaning">
<h2>Cleaning<a class="headerlink" href="#cleaning" title="Permalink to this heading"></a></h2>
<p>The cleaning bricks in <code class="docutils literal notranslate"><span class="pre">unstructured</span></code> remove unwanted text from source documents.
Examples include removing extra whitespace, boilerplate, or sentence fragments.</p>
<section id="clean">
<h3><code class="docutils literal notranslate"><span class="pre">clean</span></code><a class="headerlink" href="#clean" title="Permalink to this heading"></a></h3>
<p>Cleans a section of text with options including removing bullets, extra whitespace, dashes
and trailing punctuation. Optionally, you can choose to lowercase the output.</p>
<p>Options:</p>
<ul class="simple">
<li><p>Applies <code class="docutils literal notranslate"><span class="pre">clean_bullets</span></code> if <code class="docutils literal notranslate"><span class="pre">bullets=True</span></code>.</p></li>
<li><p>Applies <code class="docutils literal notranslate"><span class="pre">clean_extra_whitespace</span></code> if <code class="docutils literal notranslate"><span class="pre">extra_whitespace=True</span></code>.</p></li>
<li><p>Applies <code class="docutils literal notranslate"><span class="pre">clean_dashes</span></code> if <code class="docutils literal notranslate"><span class="pre">dashes=True</span></code>.</p></li>
<li><p>Applies <code class="docutils literal notranslate"><span class="pre">clean_trailing_punctuation</span></code> if <code class="docutils literal notranslate"><span class="pre">trailing_punctuation=True</span></code>.</p></li>
<li><p>Lowercases the output if <code class="docutils literal notranslate"><span class="pre">lowercase=True</span></code>.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean</span>

<span class="c1"># Returns &quot;an excellent point!&quot;</span>
<span class="n">clean</span><span class="p">(</span><span class="s2">&quot;● An excellent point!&quot;</span><span class="p">,</span> <span class="n">bullets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lowercase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Returns &quot;ITEM 1A: RISK FACTORS&quot;</span>
<span class="n">clean</span><span class="p">(</span><span class="s2">&quot;ITEM 1A:     RISK-FACTORS&quot;</span><span class="p">,</span> <span class="n">extra_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-bullets">
<h3><code class="docutils literal notranslate"><span class="pre">clean_bullets</span></code><a class="headerlink" href="#clean-bullets" title="Permalink to this heading"></a></h3>
<p>Removes bullets from the beginning of text. Bullets that do not appear at the beginning of the
text are not removed.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_bullets</span>

<span class="c1"># Returns &quot;An excellent point!&quot;</span>
<span class="n">clean_bullets</span><span class="p">(</span><span class="s2">&quot;● An excellent point!&quot;</span><span class="p">)</span>

<span class="c1"># Returns &quot;I love Morse Code! ●●●&quot;</span>
<span class="n">clean_bullets</span><span class="p">(</span><span class="s2">&quot;I love Morse Code! ●●●&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-ordered-bullets">
<h3><code class="docutils literal notranslate"><span class="pre">clean_ordered_bullets</span></code><a class="headerlink" href="#clean-ordered-bullets" title="Permalink to this heading"></a></h3>
<p>Remove alpha-numeric bullets from the beginning of text up to three “sub-section” levels.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_ordered_bullets</span>

<span class="c1"># Returns &quot;This is a very important point&quot;</span>
<span class="n">clean_bullets</span><span class="p">(</span><span class="s2">&quot;1.1 This is a very important point&quot;</span><span class="p">)</span>

<span class="c1"># Returns &quot;This is a very important point ●&quot;</span>
<span class="n">clean_bullets</span><span class="p">(</span><span class="s2">&quot;a.b This is a very important point ●&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-extra-whitespace">
<h3><code class="docutils literal notranslate"><span class="pre">clean_extra_whitespace</span></code><a class="headerlink" href="#clean-extra-whitespace" title="Permalink to this heading"></a></h3>
<p>Removes extra whitespace from a section of text. Also handles special characters
such as <code class="docutils literal notranslate"><span class="pre">\xa0</span></code> and newlines.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_extra_whitespace</span>

<span class="c1"># Returns &quot;ITEM 1A: RISK FACTORS&quot;</span>
<span class="n">clean_extra_whitespace</span><span class="p">(</span><span class="s2">&quot;ITEM 1A:     RISK FACTORS</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-dashes">
<h3><code class="docutils literal notranslate"><span class="pre">clean_dashes</span></code><a class="headerlink" href="#clean-dashes" title="Permalink to this heading"></a></h3>
<p>Removes dashes from a section of text. Also handles special characters
such as <code class="docutils literal notranslate"><span class="pre">\u2013</span></code>.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_dashes</span>

<span class="c1"># Returns &quot;ITEM 1A: RISK FACTORS&quot;</span>
<span class="n">clean_dashes</span><span class="p">(</span><span class="s2">&quot;ITEM 1A: RISK-FACTORS</span><span class="se">\u2013</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-trailing-punctuation">
<h3><code class="docutils literal notranslate"><span class="pre">clean_trailing_punctuation</span></code><a class="headerlink" href="#clean-trailing-punctuation" title="Permalink to this heading"></a></h3>
<p>Removes trailing punctuation from a section of text.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_trailing_punctuation</span>

<span class="c1"># Returns &quot;ITEM 1A: RISK FACTORS&quot;</span>
<span class="n">clean_trailing_punctuation</span><span class="p">(</span><span class="s2">&quot;ITEM 1A: RISK FACTORS.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="replace-unicode-quotes">
<h3><code class="docutils literal notranslate"><span class="pre">replace_unicode_quotes</span></code><a class="headerlink" href="#replace-unicode-quotes" title="Permalink to this heading"></a></h3>
<p>Replaces unicode quote characters such as <code class="docutils literal notranslate"><span class="pre">\x91</span></code> in strings.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">replace_unicode_quotes</span>

<span class="c1"># Returns &quot;“A lovely quote!”&quot;</span>
<span class="n">replace_unicode_characters</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x93</span><span class="s2">A lovely quote!</span><span class="se">\x94</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Returns &quot;&quot;‘A lovely quote!’&quot;</span>
<span class="n">replace_unicode_characters</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x91</span><span class="s2">A lovely quote!</span><span class="se">\x92</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="remove-punctuation">
<h3><code class="docutils literal notranslate"><span class="pre">remove_punctuation</span></code><a class="headerlink" href="#remove-punctuation" title="Permalink to this heading"></a></h3>
<p>Removes ASCII and unicode punctuation from a string.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">remove_punctuation</span>

<span class="c1"># Returns &quot;A lovely quote&quot;</span>
<span class="n">remove_punctuation</span><span class="p">(</span><span class="s2">&quot;“A lovely quote!”&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-prefix">
<h3><code class="docutils literal notranslate"><span class="pre">clean_prefix</span></code><a class="headerlink" href="#clean-prefix" title="Permalink to this heading"></a></h3>
<p>Removes the prefix from a string if they match a specified pattern.</p>
<p>Options:</p>
<ul class="simple">
<li><p>Ignores case if <code class="docutils literal notranslate"><span class="pre">ignore_case</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>Strips leading whitespace is <code class="docutils literal notranslate"><span class="pre">strip</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_prefix</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;SUMMARY: This is the best summary of all time!&quot;</span>

<span class="c1"># Returns &quot;This is the best summary of all time!&quot;</span>
<span class="n">clean_prefix</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;(SUMMARY|DESCRIPTION):&quot;</span><span class="p">,</span> <span class="n">ignore_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clean-postfix">
<h3><code class="docutils literal notranslate"><span class="pre">clean_postfix</span></code><a class="headerlink" href="#clean-postfix" title="Permalink to this heading"></a></h3>
<p>Removes the postfix from a string if they match a specified pattern.</p>
<p>Options:</p>
<ul class="simple">
<li><p>Ignores case if <code class="docutils literal notranslate"><span class="pre">ignore_case</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p>Strips trailing whitespace is <code class="docutils literal notranslate"><span class="pre">strip</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.core</span> <span class="kn">import</span> <span class="n">clean_postfix</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The end! END&quot;</span>

<span class="c1"># Returns &quot;The end!&quot;</span>
<span class="n">clean_postfix</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;(END|STOP)&quot;</span><span class="p">,</span> <span class="n">ignore_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-text-before">
<h3><code class="docutils literal notranslate"><span class="pre">extract_text_before</span></code><a class="headerlink" href="#extract-text-before" title="Permalink to this heading"></a></h3>
<p>Extracts text that occurs before the specified pattern.</p>
<p>Options:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">index</span></code> is set, extract before the <code class="docutils literal notranslate"><span class="pre">(index</span> <span class="pre">+</span> <span class="pre">1)``th</span> <span class="pre">occurence</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pattern.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">``0</span></code>.</p></li>
<li><p>Strips leading whitespace if <code class="docutils literal notranslate"><span class="pre">strip</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_text_before</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Here I am! STOP Look at me! STOP I&#39;m flying! STOP&quot;</span>

<span class="c1"># Returns &quot;Here I am!&quot;</span>
<span class="n">extract_text_before</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;STOP&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-text-after">
<h3><code class="docutils literal notranslate"><span class="pre">extract_text_after</span></code><a class="headerlink" href="#extract-text-after" title="Permalink to this heading"></a></h3>
<p>Extracts text that occurs after the specified pattern.</p>
<p>Options:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">index</span></code> is set, extract after the <code class="docutils literal notranslate"><span class="pre">(index</span> <span class="pre">+</span> <span class="pre">1)``th</span> <span class="pre">occurence</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pattern.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">``0</span></code>.</p></li>
<li><p>Strips trailing whitespace if <code class="docutils literal notranslate"><span class="pre">strip</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_text_after</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;SPEAKER 1: Look at me, I&#39;m flying!&quot;</span>

<span class="c1"># Returns &quot;Look at me, I&#39;m flying!&quot;</span>
<span class="n">extract_text_after</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;SPEAKER \d</span><span class="si">{1}</span><span class="s2">:&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-email-address">
<h3><code class="docutils literal notranslate"><span class="pre">extract_email_address</span></code><a class="headerlink" href="#extract-email-address" title="Permalink to this heading"></a></h3>
<p>Extracts email addresses from a string input and returns a list of all the email
addresses in the input string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_email_address</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Me me@email.com and You &lt;You@email.com&gt;</span>
<span class="s2">    ([ba23::58b5:2236:45g2:88h2]) (10.0.2.01)&quot;&quot;&quot;</span>

<span class="c1"># Returns &quot;[&#39;me@email.com&#39;, &#39;you@email.com&#39;]&quot;</span>
<span class="n">extract_email_address</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-ip-address">
<h3><code class="docutils literal notranslate"><span class="pre">extract_ip_address</span></code><a class="headerlink" href="#extract-ip-address" title="Permalink to this heading"></a></h3>
<p>Extracts IPv4 and IPv6 IP addresses in the input string and
returns a list of all IP address in input string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_ip_address</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Me me@email.com and You &lt;You@email.com&gt;</span>
<span class="s2">  ([ba23::58b5:2236:45g2:88h2]) (10.0.2.01)&quot;&quot;&quot;</span>

<span class="c1"># Returns &quot;[&#39;ba23::58b5:2236:45g2:88h2&#39;, &#39;10.0.2.01&#39;]&quot;</span>
<span class="n">extract_ip_address</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-ip-address-name">
<h3><code class="docutils literal notranslate"><span class="pre">extract_ip_address_name</span></code><a class="headerlink" href="#extract-ip-address-name" title="Permalink to this heading"></a></h3>
<p>Extracts the names of each IP address in the <code class="docutils literal notranslate"><span class="pre">Received</span></code> field(s) from an <code class="docutils literal notranslate"><span class="pre">.eml</span></code>
file. <code class="docutils literal notranslate"><span class="pre">extract_ip_address_name</span></code> takes in a string and returns a list of all
IP addresses in the input string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_ip_address_name</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;from ABC.DEF.local ([ba23::58b5:2236:45g2:88h2]) by</span>
<span class="s2">  </span><span class="se">\n</span><span class="s2"> ABC.DEF.local2 ([ba23::58b5:2236:45g2:88h2%25]) with mapi id</span><span class="se">\</span>
<span class="s2">  n 32.88.5467.123; Fri, 26 Mar 2021 11:04:09 +1200&quot;&quot;&quot;</span>

<span class="c1"># Returns &quot;[&#39;ABC.DEF.local&#39;, &#39;ABC.DEF.local2&#39;]&quot;</span>
<span class="n">extract_ip_address_name</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-mapi-id">
<h3><code class="docutils literal notranslate"><span class="pre">extract_mapi_id</span></code><a class="headerlink" href="#extract-mapi-id" title="Permalink to this heading"></a></h3>
<p>Extracts the <code class="docutils literal notranslate"><span class="pre">mapi</span> <span class="pre">id</span></code> in the <code class="docutils literal notranslate"><span class="pre">Received</span></code> field(s) from an <code class="docutils literal notranslate"><span class="pre">.eml</span></code>
file. <code class="docutils literal notranslate"><span class="pre">extract_mapi_id</span></code> takes in a string and returns a list of a string
containing the <code class="docutils literal notranslate"><span class="pre">mapi</span> <span class="pre">id</span></code> in the input string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_mapi_id</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;from ABC.DEF.local ([ba23::58b5:2236:45g2:88h2]) by</span>
<span class="s2">  </span><span class="se">\n</span><span class="s2"> ABC.DEF.local2 ([ba23::58b5:2236:45g2:88h2%25]) with mapi id</span><span class="se">\</span>
<span class="s2">  n 32.88.5467.123; Fri, 26 Mar 2021 11:04:09 +1200&quot;&quot;&quot;</span>

<span class="c1"># Returns &quot;[&#39;32.88.5467.123&#39;]&quot;</span>
<span class="n">extract_mapi_id</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-datetimetz">
<h3><code class="docutils literal notranslate"><span class="pre">extract_datetimetz</span></code><a class="headerlink" href="#extract-datetimetz" title="Permalink to this heading"></a></h3>
<p>Extracts the date, time, and timezone in the <code class="docutils literal notranslate"><span class="pre">Received</span></code> field(s) from an <code class="docutils literal notranslate"><span class="pre">.eml</span></code>
file. <code class="docutils literal notranslate"><span class="pre">extract_datetimetz</span></code> takes in a string and returns a datetime.datetime
object from the input string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_datetimetz</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;from ABC.DEF.local ([ba23::58b5:2236:45g2:88h2]) by</span>
<span class="s2">  </span><span class="se">\n</span><span class="s2"> ABC.DEF.local2 ([ba23::58b5:2236:45g2:88h2%25]) with mapi id</span><span class="se">\</span>
<span class="s2">  n 32.88.5467.123; Fri, 26 Mar 2021 11:04:09 +1200&quot;&quot;&quot;</span>

<span class="c1"># Returns datetime.datetime(2021, 3, 26, 11, 4, 9, tzinfo=datetime.timezone(datetime.timedelta(seconds=43200)))</span>
<span class="n">extract_datetimetz</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-us-phone-number">
<h3><code class="docutils literal notranslate"><span class="pre">extract_us_phone_number</span></code><a class="headerlink" href="#extract-us-phone-number" title="Permalink to this heading"></a></h3>
<p>Extracts a phone number from a section of text.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_us_phone_number</span>

<span class="c1"># Returns &quot;215-867-5309&quot;</span>
<span class="n">extract_us_phone_number</span><span class="p">(</span><span class="s2">&quot;Phone number: 215-867-5309&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extract-ordered-bullets">
<h3><code class="docutils literal notranslate"><span class="pre">extract_ordered_bullets</span></code><a class="headerlink" href="#extract-ordered-bullets" title="Permalink to this heading"></a></h3>
<p>Extracts alpha-numeric bullets from the beginning of text up to three “sub-section” levels.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.extract</span> <span class="kn">import</span> <span class="n">extract_ordered_bullets</span>

<span class="c1"># Returns (&quot;1&quot;, &quot;1&quot;, None)</span>
<span class="n">extract_ordered_bullets</span><span class="p">(</span><span class="s2">&quot;1.1 This is a very important point&quot;</span><span class="p">)</span>

<span class="c1"># Returns (&quot;a&quot;, &quot;1&quot;, None)</span>
<span class="n">extract_ordered_bullets</span><span class="p">(</span><span class="s2">&quot;a.1 This is a very important point&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="translate-text">
<h3><code class="docutils literal notranslate"><span class="pre">translate_text</span></code><a class="headerlink" href="#translate-text" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">translate_text</span></code> cleaning bricks translates text between languages. <code class="docutils literal notranslate"><span class="pre">translate_text</span></code>
uses the <a class="reference external" href="https://huggingface.co/Helsinki-NLP">Helsinki NLP MT models</a> from
<code class="docutils literal notranslate"><span class="pre">transformers</span></code> for machine translation. Works for Russian, Chinese, Arabic, and many
other languages.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">text</span></code>: the input string to translate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_lang</span></code>: the two letter language code for the source language of the text.
If <code class="docutils literal notranslate"><span class="pre">source_lang</span></code> is not specified,
the language will be detected using <code class="docutils literal notranslate"><span class="pre">langdetect</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_lang</span></code>: the two letter language code for the target language for translation.
Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;en&quot;</span></code>.</p></li>
</ul>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.cleaners.translate</span> <span class="kn">import</span> <span class="n">translate_text</span>

<span class="c1"># Output is &quot;I&#39;m a Berliner!&quot;</span>
<span class="n">translate_text</span><span class="p">(</span><span class="s2">&quot;Ich bin ein Berliner!&quot;</span><span class="p">)</span>

<span class="c1"># Output is &quot;I can also translate Russian!&quot;</span>
<span class="n">translate_text</span><span class="p">(</span><span class="s2">&quot;Я тоже можно переводать русский язык!&quot;</span><span class="p">,</span> <span class="s2">&quot;ru&quot;</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="staging">
<h2>Staging<a class="headerlink" href="#staging" title="Permalink to this heading"></a></h2>
<p>Staging bricks in <code class="docutils literal notranslate"><span class="pre">unstructured</span></code> prepare extracted text for downstream tasks such
as machine learning inference and data labeling.</p>
<section id="convert-to-isd">
<h3><code class="docutils literal notranslate"><span class="pre">convert_to_isd</span></code><a class="headerlink" href="#convert-to-isd" title="Permalink to this heading"></a></h3>
<p>Converts outputs to the initial structured data (ISD) format. This is the default format
for returning data in Unstructured pipeline APIs.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.base</span> <span class="kn">import</span> <span class="n">convert_to_isd</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">isd</span> <span class="o">=</span> <span class="n">convert_to_isd</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="isd-to-elements">
<h3><code class="docutils literal notranslate"><span class="pre">isd_to_elements</span></code><a class="headerlink" href="#isd-to-elements" title="Permalink to this heading"></a></h3>
<p>Converts outputs from initial structured data (ISD) format back to a list of <code class="docutils literal notranslate"><span class="pre">Text</span></code> elements.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.staging.base</span> <span class="kn">import</span> <span class="n">isd_to_elements</span>

<span class="n">isd</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;My Title&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Title&quot;</span><span class="p">},</span>
  <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;My Narrative&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;NarrativeText&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="c1"># elements will look like:</span>
<span class="c1"># [ Title(text=&quot;My Title&quot;), NarrativeText(text=&quot;My Narrative&quot;)]</span>
<span class="n">elements</span> <span class="o">=</span> <span class="n">isd_to_elements</span><span class="p">(</span><span class="n">isd</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="convert-to-isd-csv">
<h3><code class="docutils literal notranslate"><span class="pre">convert_to_isd_csv</span></code><a class="headerlink" href="#convert-to-isd-csv" title="Permalink to this heading"></a></h3>
<p>Converts outputs to the initial structured data (ISD) format as a CSV string.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.base</span> <span class="kn">import</span> <span class="n">convert_to_isd_csv</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">isd_csv</span> <span class="o">=</span> <span class="n">convert_to_isd_csv</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="convert-to-dataframe">
<h3><code class="docutils literal notranslate"><span class="pre">convert_to_dataframe</span></code><a class="headerlink" href="#convert-to-dataframe" title="Permalink to this heading"></a></h3>
<p>Converts a list of document <code class="docutils literal notranslate"><span class="pre">Element</span></code> objects to a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframe. The dataframe
will have a <code class="docutils literal notranslate"><span class="pre">text</span></code> column with the text from the element and a <code class="docutils literal notranslate"><span class="pre">type</span></code> column
indicating the element type, such as <code class="docutils literal notranslate"><span class="pre">NarrativeText</span></code> or <code class="docutils literal notranslate"><span class="pre">Title</span></code>.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.base</span> <span class="kn">import</span> <span class="n">convert_to_dataframe</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">convert_to_dataframe</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="stage-for-transformers">
<h3><code class="docutils literal notranslate"><span class="pre">stage_for_transformers</span></code><a class="headerlink" href="#stage-for-transformers" title="Permalink to this heading"></a></h3>
<p>Prepares <code class="docutils literal notranslate"><span class="pre">Text</span></code> elements for processing in <code class="docutils literal notranslate"><span class="pre">transformers</span></code> pipelines
by splitting the elements into chunks that fit into the model’s attention window.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">AutoModelForTokenClassification</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">pipeline</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.huggingface</span> <span class="kn">import</span> <span class="n">stage_for_transformers</span>

<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;hf-internal-testing/tiny-bert-for-token-classification&quot;</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForTokenClassification</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

<span class="n">nlp</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="s2">&quot;ner&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;From frost advisories this morning to a strong cold front expected later this week, the chance of fall showing up is real.</span>

<span class="s2">There&#39;s a refreshing crispness to the air, and it looks to get only more pronounced as the week goes on.</span>

<span class="s2">Frost advisories were in place this morning across portions of the Appalachians and coastal Maine as temperatures dropped into the 30s.</span>

<span class="s2">Temperatures this morning were in the 40s as far south as the Florida Panhandle.</span>

<span class="s2">And Maine even had a few reports of their first snow of the season Sunday. More cities could see their first snow later this week.</span>

<span class="s2">Yes, hello fall!</span>

<span class="s2">As temperatures moderate during the next few days, much of the east will stay right around seasonal norms, but the next blast of cold air will be strong and come with the potential for hazardous conditions.</span>

<span class="s2">&quot;A more active fall weather pattern is expected to evolve by the end of this week and continuing into the weekend as a couple of cold fronts move across the central and eastern states,&quot; the Weather Prediction Center said.</span>

<span class="s2">The potent cold front will come in from Canada with a punch of chilly air, heavy rain and strong wind.</span>

<span class="s2">The Weather Prediction Center has a slight risk of excessive rainfall for much of the Northeast and New England on Thursday, including places like New York City, Buffalo and Burlington, so we will have to look out for flash flooding in these areas.</span>

<span class="s2">&quot;More impactful weather continues to look likely with confidence growing that our region will experience the first real fall-like system with gusty to strong winds and a period of moderate to heavy rain along and ahead of a cold front passage,&quot; the National Weather Service office in Burlington wrote.</span>

<span class="s2">The potential for very heavy rain could accompany the front, bringing up to two inches of rain for much of the area, and isolated locations could see even more.</span>

<span class="s2">&quot;Ensembles [forecast models] show median rainfall totals by Wednesday night around a half inch, with a potential for some spots to see around one inch, our first substantial rainfall in at least a couple of weeks,&quot; the weather service office in Grand Rapids noted, adding, &quot;It may also get cold enough for some snow to mix in Thursday night to Friday morning, especially in the higher terrain north of Grand Rapids toward Cadillac.&quot;</span>

<span class="s2">There is also a chance for very strong winds to accompany the system.</span>

<span class="s2">The weather service is forecasting winds of 30-40 mph ahead of the cold front, which could cause some tree limbs to fall and sporadic power outages.</span>

<span class="s2">Behind the front, temperatures will fall.</span>

<span class="s2">&quot;East Coast, with highs about 5-15 degrees below average to close out the workweek and going into next weekend, with highs only in the 40s and 50s from the Great Lakes to the Northeast on most days,&quot; the Weather Prediction Center explained.</span>

<span class="s2">By the weekend, a second cold front will drop down from Canada and bring a reinforcing shot of chilly air across the eastern half of the country.&quot;&quot;&quot;</span>

<span class="n">chunks</span> <span class="o">=</span> <span class="n">stage_for_transformers</span><span class="p">([</span><span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)],</span> <span class="n">tokenizer</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">nlp</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
</pre></div>
</div>
<p>The following optional keyword arguments can be specified in
<code class="docutils literal notranslate"><span class="pre">stage_for_transformers</span></code>:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">buffer</span></code>: Indicates the number of tokens to leave as a buffer for the attention window. This is to account for special tokens like <code class="docutils literal notranslate"><span class="pre">[CLS]</span></code> that can appear at the beginning or end of an input sequence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_input_size</span></code>: The size of the attention window for the model. If not specified, the default is the <code class="docutils literal notranslate"><span class="pre">model_max_length</span></code> attribute on the tokenizer object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">split_function</span></code>: The function used to split the text into chunks to consider for adding to the attention window. Splits on spaces be default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunk_separator</span></code>: The string used to concat adjacent chunks when reconstructing the text. Uses spaces by default.</p></li>
</ul>
</div></blockquote>
<p>If you need to operate on text directly instead of <code class="docutils literal notranslate"><span class="pre">unstructured</span></code> <code class="docutils literal notranslate"><span class="pre">Text</span></code>
objects, use the <code class="docutils literal notranslate"><span class="pre">chunk_by_attention_window</span></code> helper function. Simply modify
the example above to include the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.staging.huggingface</span> <span class="kn">import</span> <span class="n">chunk_by_attention_window</span>

<span class="n">chunks</span> <span class="o">=</span> <span class="n">chunk_by_attention_window</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">nlp</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="stage-for-label-studio">
<h3><code class="docutils literal notranslate"><span class="pre">stage_for_label_studio</span></code><a class="headerlink" href="#stage-for-label-studio" title="Permalink to this heading"></a></h3>
<p>Formats outputs for upload to LabelStudio. After running <code class="docutils literal notranslate"><span class="pre">stage_for_label_studio</span></code>, you can
write the results to a JSON folder that is ready to be included in a new LabelStudio project.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.label_studio</span> <span class="kn">import</span> <span class="n">stage_for_label_studio</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">label_studio_data</span> <span class="o">=</span> <span class="n">stage_for_label_studio</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">text_field</span><span class="o">=</span><span class="s2">&quot;my_text&quot;</span><span class="p">,</span> <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;my_id&quot;</span><span class="p">)</span>

<span class="c1"># The resulting JSON file is ready to be uploaded to LabelStudio</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;label_studio.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">label_studio_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also include pre-annotations and predictions as part of your LabelStudio upload.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">annotations</span></code> kwarg is a list of lists. If <code class="docutils literal notranslate"><span class="pre">annotations</span></code> is specified, there must be a list of
annotations for each element in the <code class="docutils literal notranslate"><span class="pre">elements</span></code> list. If an element does not have any annotations,
use an empty list.
The following shows an example of how to upload annotations for the “Text Classification”
task in LabelStudio:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.label_studio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">stage_for_label_studio</span><span class="p">,</span>
    <span class="n">LabelStudioAnnotation</span><span class="p">,</span>
    <span class="n">LabelStudioResult</span><span class="p">,</span>
<span class="p">)</span>



<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="p">[[</span>
  <span class="n">LabelStudioAnnotation</span><span class="p">(</span>
      <span class="n">result</span><span class="o">=</span><span class="p">[</span>
          <span class="n">LabelStudioResult</span><span class="p">(</span>
              <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;choices&quot;</span><span class="p">,</span>
              <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;choices&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Positive&quot;</span><span class="p">]},</span>
              <span class="n">from_name</span><span class="o">=</span><span class="s2">&quot;sentiment&quot;</span><span class="p">,</span>
              <span class="n">to_name</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="p">)</span>
      <span class="p">]</span>
  <span class="p">)</span>
<span class="p">]]</span>
<span class="n">label_studio_data</span> <span class="o">=</span> <span class="n">stage_for_label_studio</span><span class="p">(</span>
    <span class="n">elements</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span>
    <span class="n">text_field</span><span class="o">=</span><span class="s2">&quot;my_text&quot;</span><span class="p">,</span>
    <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;my_id&quot;</span>
<span class="p">)</span>

<span class="c1"># The resulting JSON file is ready to be uploaded to LabelStudio</span>
<span class="c1"># with annotations included</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;label_studio.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">label_studio_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Similar to annotations, the <code class="docutils literal notranslate"><span class="pre">predictions</span></code> kwarg is also a list of lists. A <code class="docutils literal notranslate"><span class="pre">prediction</span></code> is an annotation with
the addition of a <code class="docutils literal notranslate"><span class="pre">score</span></code> value. If <code class="docutils literal notranslate"><span class="pre">predictions</span></code> is specified, there must be a list of
predictions for each element in the <code class="docutils literal notranslate"><span class="pre">elements</span></code> list. If an element does not have any predictions, use an empty list.
The following shows an example of how to upload predictions for the “Text Classification”
task in LabelStudio:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.label_studio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">stage_for_label_studio</span><span class="p">,</span>
    <span class="n">LabelStudioPrediction</span><span class="p">,</span>
    <span class="n">LabelStudioResult</span><span class="p">,</span>
<span class="p">)</span>



<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="p">[[</span>
  <span class="n">LabelStudioPrediction</span><span class="p">(</span>
      <span class="n">result</span><span class="o">=</span><span class="p">[</span>
          <span class="n">LabelStudioResult</span><span class="p">(</span>
              <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;choices&quot;</span><span class="p">,</span>
              <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;choices&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Positive&quot;</span><span class="p">]},</span>
              <span class="n">from_name</span><span class="o">=</span><span class="s2">&quot;sentiment&quot;</span><span class="p">,</span>
              <span class="n">to_name</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="p">)</span>
      <span class="p">],</span>
      <span class="n">score</span><span class="o">=</span><span class="mf">0.68</span>
  <span class="p">)</span>
<span class="p">]]</span>
<span class="n">label_studio_data</span> <span class="o">=</span> <span class="n">stage_for_label_studio</span><span class="p">(</span>
    <span class="n">elements</span><span class="p">,</span>
    <span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
    <span class="n">text_field</span><span class="o">=</span><span class="s2">&quot;my_text&quot;</span><span class="p">,</span>
    <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;my_id&quot;</span>
<span class="p">)</span>

<span class="c1"># The resulting JSON file is ready to be uploaded to LabelStudio</span>
<span class="c1"># with annotations included</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;label_studio.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">label_studio_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The following shows an example of how to upload annotations for the “Named Entity Recognition”
task in LabelStudio:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.label_studio</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">stage_for_label_studio</span><span class="p">,</span>
    <span class="n">LabelStudioAnnotation</span><span class="p">,</span>
    <span class="n">LabelStudioResult</span><span class="p">,</span>
<span class="p">)</span>



<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">annotations</span> <span class="o">=</span> <span class="p">[[</span>
  <span class="n">LabelStudioAnnotation</span><span class="p">(</span>
      <span class="n">result</span><span class="o">=</span><span class="p">[</span>
          <span class="n">LabelStudioResult</span><span class="p">(</span>
              <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span>
              <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Narrative&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;MISC&quot;</span><span class="p">]},</span>
              <span class="n">from_name</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
              <span class="n">to_name</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
          <span class="p">)</span>
      <span class="p">]</span>
  <span class="p">)</span>
<span class="p">]]</span>
<span class="n">label_studio_data</span> <span class="o">=</span> <span class="n">stage_for_label_studio</span><span class="p">(</span>
    <span class="n">elements</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span>
    <span class="n">text_field</span><span class="o">=</span><span class="s2">&quot;my_text&quot;</span><span class="p">,</span>
    <span class="n">id_field</span><span class="o">=</span><span class="s2">&quot;my_id&quot;</span>
<span class="p">)</span>

<span class="c1"># The resulting JSON file is ready to be uploaded to LabelStudio</span>
<span class="c1"># with annotations included</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;label_studio.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">label_studio_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://labelstud.io/tags/labels.html">LabelStudio docs</a> for a full list of options
for labels and annotations.</p>
</section>
<section id="stage-for-prodigy">
<h3><code class="docutils literal notranslate"><span class="pre">stage_for_prodigy</span></code><a class="headerlink" href="#stage-for-prodigy" title="Permalink to this heading"></a></h3>
<p>Formats outputs in JSON format for use with <a class="reference external" href="https://prodi.gy/docs/api-loaders">Prodigy</a>. After running <code class="docutils literal notranslate"><span class="pre">stage_for_prodigy</span></code>, you can
write the results to a JSON file that is ready to be used with Prodigy.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.prodigy</span> <span class="kn">import</span> <span class="n">stage_for_prodigy</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;title&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">}]</span>
<span class="n">prodigy_data</span> <span class="o">=</span> <span class="n">stage_for_prodigy</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="c1"># The resulting JSON file is ready to be used with Prodigy</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;prodigy.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">prodigy_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note</strong>: Prodigy recommends <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> format for feeding data to API loaders. After running <code class="docutils literal notranslate"><span class="pre">stage_for_prodigy</span></code>, you can
use the <code class="docutils literal notranslate"><span class="pre">save_as_jsonl</span></code> utility function to save the formatted data to a <code class="docutils literal notranslate"><span class="pre">.jsonl</span></code> file that is ready to be used with Prodigy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.prodigy</span> <span class="kn">import</span> <span class="n">stage_for_prodigy</span>
<span class="kn">from</span> <span class="nn">unstructured.utils</span> <span class="kn">import</span> <span class="n">save_as_jsonl</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;title&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">}]</span>
<span class="n">prodigy_data</span> <span class="o">=</span> <span class="n">stage_for_prodigy</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="c1"># The resulting jsonl file is ready to be used with Prodigy.</span>
<span class="n">save_as_jsonl</span><span class="p">(</span><span class="n">prodigy_data</span><span class="p">,</span> <span class="s2">&quot;prodigy.jsonl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="stage-csv-for-prodigy">
<h3><code class="docutils literal notranslate"><span class="pre">stage_csv_for_prodigy</span></code><a class="headerlink" href="#stage-csv-for-prodigy" title="Permalink to this heading"></a></h3>
<p>Formats outputs in CSV format for use with <a class="reference external" href="https://prodi.gy/docs/api-loaders">Prodigy</a>. After running <code class="docutils literal notranslate"><span class="pre">stage_csv_for_prodigy</span></code>, you can
write the results to a CSV file that is ready to be used with Prodigy.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.prodigy</span> <span class="kn">import</span> <span class="n">stage_csv_for_prodigy</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;title&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;news&quot;</span><span class="p">}]</span>
<span class="n">prodigy_csv_data</span> <span class="o">=</span> <span class="n">stage_csv_for_prodigy</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="c1"># The resulting CSV file is ready to be used with Prodigy</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;prodigy.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csv_file</span><span class="p">:</span>
    <span class="n">csv_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prodigy_csv_data</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="stage-for-label-box">
<h3><code class="docutils literal notranslate"><span class="pre">stage_for_label_box</span></code><a class="headerlink" href="#stage-for-label-box" title="Permalink to this heading"></a></h3>
<p>Formats outputs for use with <a class="reference external" href="https://docs.labelbox.com/docs/overview">LabelBox</a>. LabelBox accepts cloud-hosted data
and does not support importing text directly. The <code class="docutils literal notranslate"><span class="pre">stage_for_label_box</span></code> does the following:</p>
<ul class="simple">
<li><p>Stages the data files in the <code class="docutils literal notranslate"><span class="pre">output_directory</span></code> specified in function arguments to be uploaded to a cloud storage service.</p></li>
<li><p>Returns a config of type <code class="docutils literal notranslate"><span class="pre">List[Dict[str,</span> <span class="pre">Any]]</span></code> that can be written to a <code class="docutils literal notranslate"><span class="pre">json</span></code> file and imported into LabelBox.</p></li>
</ul>
<p><strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">stage_for_label_box</span></code> does not upload the data to remote storage such as S3. Users can upload the data to S3
using <code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">s3</span> <span class="pre">sync</span> <span class="pre">${output_directory}</span> <span class="pre">${url_prefix}</span></code> after running the <code class="docutils literal notranslate"><span class="pre">stage_for_label_box</span></code> staging brick.</p>
<p>Examples:</p>
<p>The following example demonstrates generating a <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file that can be used with LabelBox and uploading the staged data
files to an S3 bucket.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.label_box</span> <span class="kn">import</span> <span class="n">stage_for_label_box</span>

<span class="c1"># The S3 Bucket name where data files should be uploaded.</span>
<span class="n">S3_BUCKET_NAME</span> <span class="o">=</span> <span class="s2">&quot;labelbox-staging-bucket&quot;</span>

<span class="c1"># The S3 key prefix (I.e. directory) where data files should be stored.</span>
<span class="n">S3_BUCKET_KEY_PREFIX</span> <span class="o">=</span> <span class="s2">&quot;data/&quot;</span>

<span class="c1"># The URL prefix where the data files will be accessed.</span>
<span class="n">S3_URL_PREFIX</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">S3_BUCKET_NAME</span><span class="si">}</span><span class="s2">.s3.amazonaws.com/</span><span class="si">{</span><span class="n">S3_BUCKET_KEY_PREFIX</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># The local output directory where the data files will be staged for uploading to a Cloud Storage service.</span>
<span class="n">LOCAL_OUTPUT_DIRECTORY</span> <span class="o">=</span> <span class="s2">&quot;/tmp/labelbox-staging&quot;</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>

<span class="n">labelbox_config</span> <span class="o">=</span> <span class="n">stage_for_label_box</span><span class="p">(</span>
    <span class="n">elements</span><span class="p">,</span>
    <span class="n">output_directory</span><span class="o">=</span><span class="n">LOCAL_OUTPUT_DIRECTORY</span><span class="p">,</span>
    <span class="n">url_prefix</span><span class="o">=</span><span class="n">S3_URL_PREFIX</span><span class="p">,</span>
    <span class="n">external_ids</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id1&quot;</span><span class="p">,</span> <span class="s2">&quot;id2&quot;</span><span class="p">],</span>
    <span class="n">attachments</span><span class="o">=</span><span class="p">[[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;RAW_TEXT&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Title description&quot;</span><span class="p">}],</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;RAW_TEXT&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Narrative Description&quot;</span><span class="p">}]],</span>
    <span class="n">create_directory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># The resulting JSON config file is ready to be used with LabelBox.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;config.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">labelbox_config_file</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">labelbox_config</span><span class="p">,</span> <span class="n">labelbox_config_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>


<span class="c1"># Upload staged data files to S3 from local output directory.</span>
<span class="k">def</span> <span class="nf">upload_staged_files</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">boto3</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">LOCAL_OUTPUT_DIRECTORY</span><span class="p">):</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LOCAL_OUTPUT_DIRECTORY</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">upload_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">S3_BUCKET_KEY_PREFIX</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">s3</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="n">S3_BUCKET_NAME</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="n">upload_key</span><span class="p">)</span>

<span class="n">upload_staged_files</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="stage-for-datasaur">
<h3><code class="docutils literal notranslate"><span class="pre">stage_for_datasaur</span></code><a class="headerlink" href="#stage-for-datasaur" title="Permalink to this heading"></a></h3>
<p>Formats a list of <code class="docutils literal notranslate"><span class="pre">Text</span></code> elements as input to token based tasks in Datasaur.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Text</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.datasaur</span> <span class="kn">import</span> <span class="n">stage_for_datasaur</span>

<span class="n">elements</span>  <span class="o">=</span> <span class="p">[</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;Text1&quot;</span><span class="p">),</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;Text2&quot;</span><span class="p">)]</span>
<span class="n">datasaur_data</span> <span class="o">=</span> <span class="n">stage_for_datasaur</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is a list of dictionaries, each one with two keys:
“text” with the content of the element and
“entities” with an empty list.</p>
<p>You can also specify specify entities in the <code class="docutils literal notranslate"><span class="pre">stage_for_datasaur</span></code> brick. Entities
you specify in the input will be included in the entities key in the output. The list
of entities is a list of dictionaries and must have all of the keys in the example below.
The list of entities must be the same length as the list of elements. Use an empty
list for any elements that do not have any entities.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Text</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.datasaur</span> <span class="kn">import</span> <span class="n">stage_for_datasaur</span>

<span class="n">elements</span>  <span class="o">=</span> <span class="p">[</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;Hi my name is Matt.&quot;</span><span class="p">)]</span>
<span class="n">entities</span> <span class="o">=</span> <span class="p">[[{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Matt&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;PER&quot;</span><span class="p">,</span> <span class="s2">&quot;start_idx&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;end_idx&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}]]</span>
<span class="n">datasaur_data</span> <span class="o">=</span> <span class="n">stage_for_datasaur</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">entities</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="stage-for-argilla">
<h3><code class="docutils literal notranslate"><span class="pre">stage_for_argilla</span></code><a class="headerlink" href="#stage-for-argilla" title="Permalink to this heading"></a></h3>
<p>Convert a list of <code class="docutils literal notranslate"><span class="pre">Text</span></code> elements to an <a class="reference external" href="https://docs.argilla.io/en/latest/reference/python/python_client.html#python-ref-datasets">Argilla Dataset</a>.
The type of Argilla dataset to be generated can be specified with <code class="docutils literal notranslate"><span class="pre">argilla_task</span></code>
parameter. Valid values for <code class="docutils literal notranslate"><span class="pre">argilla_task</span></code> are <code class="docutils literal notranslate"><span class="pre">&quot;text_classification&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;token_classification&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;text2text&quot;</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;token_classification&quot;</span></code> is selected
and <code class="docutils literal notranslate"><span class="pre">tokens</span></code> is not included in the optional kwargs, the <code class="docutils literal notranslate"><span class="pre">nltk</span></code> word tokenizer
is used by default.</p>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">unstructured.documents.elements</span> <span class="kn">import</span> <span class="n">Title</span><span class="p">,</span> <span class="n">NarrativeText</span>
<span class="kn">from</span> <span class="nn">unstructured.staging.argilla</span> <span class="kn">import</span> <span class="n">stage_for_argilla</span>

<span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Title&quot;</span><span class="p">),</span> <span class="n">NarrativeText</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Narrative&quot;</span><span class="p">)]</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;title&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">}]</span>

<span class="n">argilla_dataset</span> <span class="o">=</span> <span class="n">stage_for_argilla</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="s2">&quot;text_classification&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="examples.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Examples</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="elements.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Elements</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022-2023, Unstructured Technologies
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Bricks</a><ul>
<li><a class="reference internal" href="#partitioning">Partitioning</a><ul>
<li><a class="reference internal" href="#partition"><code class="docutils literal notranslate"><span class="pre">partition</span></code></a></li>
<li><a class="reference internal" href="#partition-docx"><code class="docutils literal notranslate"><span class="pre">partition_docx</span></code></a></li>
<li><a class="reference internal" href="#partition-doc"><code class="docutils literal notranslate"><span class="pre">partition_doc</span></code></a></li>
<li><a class="reference internal" href="#partition-pptx"><code class="docutils literal notranslate"><span class="pre">partition_pptx</span></code></a></li>
<li><a class="reference internal" href="#partition-html"><code class="docutils literal notranslate"><span class="pre">partition_html</span></code></a></li>
<li><a class="reference internal" href="#partition-pdf"><code class="docutils literal notranslate"><span class="pre">partition_pdf</span></code></a></li>
<li><a class="reference internal" href="#partition-image"><code class="docutils literal notranslate"><span class="pre">partition_image</span></code></a></li>
<li><a class="reference internal" href="#partition-email"><code class="docutils literal notranslate"><span class="pre">partition_email</span></code></a></li>
<li><a class="reference internal" href="#partition-text"><code class="docutils literal notranslate"><span class="pre">partition_text</span></code></a></li>
<li><a class="reference internal" href="#extract-attachment-info"><code class="docutils literal notranslate"><span class="pre">extract_attachment_info</span></code></a></li>
<li><a class="reference internal" href="#is-bulleted-text"><code class="docutils literal notranslate"><span class="pre">is_bulleted_text</span></code></a></li>
<li><a class="reference internal" href="#is-possible-narrative-text"><code class="docutils literal notranslate"><span class="pre">is_possible_narrative_text</span></code></a></li>
<li><a class="reference internal" href="#is-possible-title"><code class="docutils literal notranslate"><span class="pre">is_possible_title</span></code></a></li>
<li><a class="reference internal" href="#contains-us-phone-number"><code class="docutils literal notranslate"><span class="pre">contains_us_phone_number</span></code></a></li>
<li><a class="reference internal" href="#contains-verb"><code class="docutils literal notranslate"><span class="pre">contains_verb</span></code></a></li>
<li><a class="reference internal" href="#sentence-count"><code class="docutils literal notranslate"><span class="pre">sentence_count</span></code></a></li>
<li><a class="reference internal" href="#exceeds-cap-ratio"><code class="docutils literal notranslate"><span class="pre">exceeds_cap_ratio</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#cleaning">Cleaning</a><ul>
<li><a class="reference internal" href="#clean"><code class="docutils literal notranslate"><span class="pre">clean</span></code></a></li>
<li><a class="reference internal" href="#clean-bullets"><code class="docutils literal notranslate"><span class="pre">clean_bullets</span></code></a></li>
<li><a class="reference internal" href="#clean-ordered-bullets"><code class="docutils literal notranslate"><span class="pre">clean_ordered_bullets</span></code></a></li>
<li><a class="reference internal" href="#clean-extra-whitespace"><code class="docutils literal notranslate"><span class="pre">clean_extra_whitespace</span></code></a></li>
<li><a class="reference internal" href="#clean-dashes"><code class="docutils literal notranslate"><span class="pre">clean_dashes</span></code></a></li>
<li><a class="reference internal" href="#clean-trailing-punctuation"><code class="docutils literal notranslate"><span class="pre">clean_trailing_punctuation</span></code></a></li>
<li><a class="reference internal" href="#replace-unicode-quotes"><code class="docutils literal notranslate"><span class="pre">replace_unicode_quotes</span></code></a></li>
<li><a class="reference internal" href="#remove-punctuation"><code class="docutils literal notranslate"><span class="pre">remove_punctuation</span></code></a></li>
<li><a class="reference internal" href="#clean-prefix"><code class="docutils literal notranslate"><span class="pre">clean_prefix</span></code></a></li>
<li><a class="reference internal" href="#clean-postfix"><code class="docutils literal notranslate"><span class="pre">clean_postfix</span></code></a></li>
<li><a class="reference internal" href="#extract-text-before"><code class="docutils literal notranslate"><span class="pre">extract_text_before</span></code></a></li>
<li><a class="reference internal" href="#extract-text-after"><code class="docutils literal notranslate"><span class="pre">extract_text_after</span></code></a></li>
<li><a class="reference internal" href="#extract-email-address"><code class="docutils literal notranslate"><span class="pre">extract_email_address</span></code></a></li>
<li><a class="reference internal" href="#extract-ip-address"><code class="docutils literal notranslate"><span class="pre">extract_ip_address</span></code></a></li>
<li><a class="reference internal" href="#extract-ip-address-name"><code class="docutils literal notranslate"><span class="pre">extract_ip_address_name</span></code></a></li>
<li><a class="reference internal" href="#extract-mapi-id"><code class="docutils literal notranslate"><span class="pre">extract_mapi_id</span></code></a></li>
<li><a class="reference internal" href="#extract-datetimetz"><code class="docutils literal notranslate"><span class="pre">extract_datetimetz</span></code></a></li>
<li><a class="reference internal" href="#extract-us-phone-number"><code class="docutils literal notranslate"><span class="pre">extract_us_phone_number</span></code></a></li>
<li><a class="reference internal" href="#extract-ordered-bullets"><code class="docutils literal notranslate"><span class="pre">extract_ordered_bullets</span></code></a></li>
<li><a class="reference internal" href="#translate-text"><code class="docutils literal notranslate"><span class="pre">translate_text</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#staging">Staging</a><ul>
<li><a class="reference internal" href="#convert-to-isd"><code class="docutils literal notranslate"><span class="pre">convert_to_isd</span></code></a></li>
<li><a class="reference internal" href="#isd-to-elements"><code class="docutils literal notranslate"><span class="pre">isd_to_elements</span></code></a></li>
<li><a class="reference internal" href="#convert-to-isd-csv"><code class="docutils literal notranslate"><span class="pre">convert_to_isd_csv</span></code></a></li>
<li><a class="reference internal" href="#convert-to-dataframe"><code class="docutils literal notranslate"><span class="pre">convert_to_dataframe</span></code></a></li>
<li><a class="reference internal" href="#stage-for-transformers"><code class="docutils literal notranslate"><span class="pre">stage_for_transformers</span></code></a></li>
<li><a class="reference internal" href="#stage-for-label-studio"><code class="docutils literal notranslate"><span class="pre">stage_for_label_studio</span></code></a></li>
<li><a class="reference internal" href="#stage-for-prodigy"><code class="docutils literal notranslate"><span class="pre">stage_for_prodigy</span></code></a></li>
<li><a class="reference internal" href="#stage-csv-for-prodigy"><code class="docutils literal notranslate"><span class="pre">stage_csv_for_prodigy</span></code></a></li>
<li><a class="reference internal" href="#stage-for-label-box"><code class="docutils literal notranslate"><span class="pre">stage_for_label_box</span></code></a></li>
<li><a class="reference internal" href="#stage-for-datasaur"><code class="docutils literal notranslate"><span class="pre">stage_for_datasaur</span></code></a></li>
<li><a class="reference internal" href="#stage-for-argilla"><code class="docutils literal notranslate"><span class="pre">stage_for_argilla</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" src="_static/jquery.js"></script>
    <script integrity="sha384-lSZeSIVKp9myfKbDQ3GkN/KHjUc+mzg17VKDN4Y2kUeBSJioB9QSM639vM9fuY//" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/js/githubStargazers.js"></script>
    <script src="_static/js/sidebarScrollPosition.js"></script>
    </body>
</html>